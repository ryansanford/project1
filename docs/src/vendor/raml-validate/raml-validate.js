(function(root){var toString=Function.prototype.call.bind(Object.prototype.toString);var isDate=function(check){return toString(check)==="[object Date]"&&!isNaN(check.getTime())};var isBoolean=function(check){return typeof check==="boolean"};var isString=function(check){return typeof check==="string"};var isInteger=function(check){return typeof check==="number"&&check%1===0};var isNumber=function(check){return typeof check==="number"&&isFinite(check)};var isJSON=function(check){try{JSON.parse(check);
return true}catch(e){return false}};var isUnion=function(check,key,object,configs){var any=false;configs.forEach(function(config){config.unionTypes.forEach(function(type){any=any||TYPES[type](check,key,object,configs)})});return any};var isFile=function(check){return check.constructor===File};var isArray=function(check,key,object,configs){if(!Array.isArray(check))return false;var isArray=true;configs.forEach(function(config){if(config.hasOwnProperty("items"))check.forEach(function(elem){isArray=isArray&&
TYPES[config.items](elem,key,object,configs)})});return isArray};var isMinimum=function(min){return function(check){return check>=min}};var isMaximum=function(max){return function(check){return check<=max}};var isMinimumLength=function(min){return function(check){return check.length>=min}};var isMaximumLength=function(max){return function(check){return check.length<=max}};var isEnum=function(values){return function(check){return values.indexOf(check)>-1}};var isPattern=function(pattern){if(toString(pattern)!==
"[object RegExp]")pattern=new RegExp(pattern);return pattern.test.bind(pattern)};var isValidFileTypes=function(values){return function(check){check=check.toLowerCase();var checkInValue=values.find(function(value){return value.toLowerCase()===check});return checkInValue?true:false}};var hasMinimumItems=function(min){return function(check){return check.length>=min}};var hasMaximumItems=function(max){return function(check){return check.length<=max}};var hasUniqueItems=function(checkUniqueness){return function(check){if(!checkUniqueness)return true;
var unique={},i;for(i=0;i<check.length;i+=1){if(unique[check[i]])return false;unique[check[i]]=true}return true}};var toValidationObject=function(valid,rule,value,key){return{valid:valid,rule:rule,value:value,key:key}};var toValidationFunction=function(config,rules){var fns=[];Object.keys(config).forEach(function(rule){if(rules.hasOwnProperty(rule))fns.push([rule,rules[rule](config[rule],rule)])});return function(value,key,object){for(var i=0;i<fns.length;i++){var valid=fns[i][1](value,key,object);
if(!valid)return toValidationObject(false,fns[i][0],value,key)}return toValidationObject(true,null,value,key)}};var toValidation=function(configs,rules,types){configs=Array.isArray(configs)?configs:[configs];var isOptional=!configs.length;var simpleValidations=[];var repeatValidations=[];var repeatable=false;configs.forEach(function(config){var validation=[config.type,toValidationFunction(config,rules)];if(!config.required)isOptional=true;if(config.repeat){repeatValidations.push(validation);repeatable=
true}else simpleValidations.push(validation)});return function(value,key,object){var isArray=Array.isArray(value)&&repeatable;if(value==null||isArray&&value.length===0)return toValidationObject(isOptional,"required",value,key);var values=isArray?value:[value];var validations=isArray?repeatValidations:simpleValidations;var response=toValidationObject(false,validations.length?"type":"repeat",value,key);validations.some(function(validation){if(!types.hasOwnProperty(validation[0]))return false;var isType=
values.every(function(value){return types[validation[0]](value,key,object,configs)});if(!isType)return false;values.every(function(value){return(response=validation[1](value,key,object)).valid});return true});return response}};function isNativeType(typeName){typeName=typeName.replace("[]","");var nativeTypes=["object","string","number","integer","boolean","date-only","time-only","datetime-only","datetime","file","array"];return nativeTypes.indexOf(typeName)!==-1}function convertType(config){var newConfig=
{};Object.keys(config).forEach(function(key){newConfig[key]=config[key]});if(Array.isArray(newConfig.type))newConfig.type=newConfig.type.map(function(aType){var newType=aType.replace("[]","");var parts=aType.split("|");if(parts.length>1){newType="union";newConfig.unionTypes=parts.map(function(part){part=part.trim();return!isNativeType(part)?"object":part})}else newType=!isNativeType(newType)?"object":newType;return newType});return newConfig}var TYPES={date:isDate,"date-only":isDate,"time-only":isDate,
"datetime-only":isDate,datetime:isDate,number:isNumber,integer:isInteger,"boolean":isBoolean,string:isString,object:isJSON,union:isUnion,array:isArray,file:isFile};RAMLValidate=function(){var validate=function(schema){var validations={};Object.keys(schema).forEach(function(param){var config=convertType(schema[param]);var rules=validate.RULES;var types=validate.TYPES;validations[param]=toValidation(config,rules,types)});return function(model){model=model||{};var errors=Object.keys(validations).map(function(param){var value=
model[param];var validation=validations[param];return validation(value,param,model)}).filter(function(validation){return!validation.valid});return{valid:errors.length===0,errors:errors}}};validate.TYPES=TYPES;validate.RULES={minimum:isMinimum,maximum:isMaximum,minLength:isMinimumLength,maxLength:isMaximumLength,"enum":isEnum,pattern:isPattern,minItems:hasMinimumItems,maxItems:hasMaximumItems,uniqueItems:hasUniqueItems,fileTypes:isValidFileTypes};return validate};if(typeof define==="function"&&define.amd)define([],
function(){return RAMLValidate});else if(typeof exports==="object")module.exports=RAMLValidate;else root.RAMLValidate=RAMLValidate})(this);